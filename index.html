<!DOCTYPE html>
<html lang="en" class="flex-center">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
    <!-- the AFrame library and 3rd party components -->
        <script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe-master.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/aframe-environment-component@1.3.2/dist/aframe-environment-component.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/components/sphere-collider.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/aframe-extras.controls.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/c-frame/physx@v0.1.0/dist/physx.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls@0.4.3/dist/aframe-blink-controls.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/handy-work@3.1.10/build/handy-controls.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/handy-work@3.1.10/build/magnet-helpers.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/aframe-htmlmesh@2.0.1/build/aframe-html.min.js"></script>
        <script src="xr-boilerplate/ar-shadow-helper.js"></script>
        <script src="xr-boilerplate/ar-cursor.js"></script>
        <script src="xr-boilerplate/simple-navmesh-constraint.js"></script>
        <script src="xr-boilerplate/model-utils.js"></script>

        <script src="xr-boilerplate/main.js"></script>

    <script src="maze.js"></script>

    <!--<script>
        // WebXR requires https: to work so ensure redirected if needed.
        if (location.hostname !== 'localhost' && window.location.protocol === 'http:') window.location.protocol = 'https:';
    </script>-->
    
    <!-- <link rel="stylesheet" href="index.css"> -->
</head>
<body class="flex-center">
    <a-scene 
        physx="autoLoad: true; delay: 500; wasmUrl: ./physx.release.wasm;"
        webxr="overlayElement:#dom-overlay;"
        reflection="directionalLight:#dirlight;"> <!--add "embedded" when ready for crt filter | fog="type: exponential; color: black; density: 0.2" style="position: fixed;" vr-mode-ui="enabled: false"-->

        <a-assets>
            <a-asset-item id="ermine" src="GLB/ermine_statue.glb"></a-asset-item>
            <img id="bricks-map" src="PNG/bricks_0007_normal_opengl_1k.png">
            <img id="bricks-img" src="JPG/bricks_0007_ao_1k.jpg">
            <img id="brickz-map" src="PNG/bricks_0019_normal_opengl_1k.png">
            <img id="brickz-img" src="JPG/bricks_0019_ao_1k.jpg">
            <img id="rocks-map" src="PNG/rock_0007_normal_opengl_1k.png">
            <img id="rocks-img" src="JPG/rock_0007_ao_1k.jpg">            
        </a-assets>

        <!-- Row 1 -->
                                <!-- "X"⬎  (2D)  ⬐"Y" -->
        <a-entity physx-body="type: static" x-hallway position="   0   0   0">
            <a-entity gltf-model="#ermine" physx-body="type: dynamic" position="0 0.4 -1"></a-entity>
        </a-entity>

        <!-- Player Camera Rig with Light -->
        <a-entity id="rig" position="0 1.6 0">
            <a-camera position="0 0 0" camera fov="100" look-controls="pointerLockEnabled: true;" movement-controls="controls: checkpoint;" checkpoint-controls="mode: animate; animateSpeed: 5;" wasd-controls="enabled: true;">
                <a-cursor material="color: white; shader: flat;"></a-cursor>
                <a-entity light="type: spot; intensity: 2; angle: 90; distance: 20; penumbra: 0.9; color: #fffeee;" position="0 0 0"></a-entity>
                <a-entity light="type: spot; intensity: 2; angle: 40; distance: 5; penumbra: 0.3; color: #fffeee;" position="0 0 0"></a-entity>
            </a-camera> 
        </a-entity>

        <a-sky color="blue"></a-sky>
    </a-scene>
</body>
<svg color-interpolation-filters="sRGB" viewBox="0 0 0 0">
	<defs>
		<filter id="chromatic-aberration">
			<feColorMatrix type="matrix" in="SourceGraphic" result="blue" values="
				0.000  0.000  0.000  0.000  0.000
				0.000  1.000  0.000  0.000  0.000 
				0.000  0.000  1.000  0.000  0.000 
				0.000  0.000  0.000  1.000  0.000"/>
			<feOffset in="blue" dx="-1" dy="-1" result="blue_channel"/>
			<feColorMatrix type="matrix" in="SourceGraphic" result="red" values="
				1.000  0.000  0.000  0.000  0.000
				0.000  0.000  0.000  0.000  0.000 
				0.000  0.000  0.000  0.000  0.000 
				0.000  0.000  0.000  1.000  0.000"/>
			<feOffset in="red" dx="1" dy="1" result="red_channel"/>
			<feBlend mode="screen" in="red_channel" in2="blue_channel"/>
		</filter>
		<filter id="fisheye">
            <feImage xlink:href="WEBP/fisheye.webp" result="lightMap" preserveAspectRatio="xMidYMid slice"/>
            <feDisplacementMap in2="lightMap" in="SourceGraphic" xChannelSelector="R" yChannelSelector="G" scale="120"/>
        </filter>
        <filter id="dither" color-interpolation-filters="sRGB" x="0" y="0" width="100%" height="100%">
            <feImage width="4" height="4" xlink:href="PNG/bayer.png"/>
            <feTile/>
            <feComposite operator="arithmetic" k1="0" k2="1" k3="1" k4="-0.2" in="SourceGraphic"/>
            <feComponentTransfer>
              <feFuncR type="discrete" tableValues="0 0.8"/>
              <feFuncG type="discrete" tableValues="0 0.9"/>
              <feFuncB type="discrete" tableValues="0 1"/>
            </feComponentTransfer>
        </filter>
	</defs>
</svg>
</html>